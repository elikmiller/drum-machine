(this["webpackJsonpdrum-machine"]=this["webpackJsonpdrum-machine"]||[]).push([[0],{42:function(t,e,n){"use strict";n.r(e);var i=n(1),a=n(13),o=n.n(a),s=n(3),c=n(0),r=function(t){var e=t.isActive,n=t.isPlaying,i=t.onClick;return Object(c.jsx)("div",{style:{height:"16px",minWidth:"16px",margin:"0 8px",borderRadius:"1px",backgroundColor:n?"#1e87f0":e?"#32d296":"#f8f8f8"},onClick:i})},u=function(t){var e=t.trackName,n=t.trackNotes,i=t.lastNotePlayed,a=(t.isPlaying,t.toggleNote);return Object(c.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"10px",padding:"5px",border:"1px solid rgba(255, 255, 255, 0.75)",borderRadius:"4px"},children:[Object(c.jsx)("div",{style:{minWidth:"96px"},children:e}),n.map((function(t,n){return Object(c.jsx)(r,{isActive:t,isPlaying:(n+1)%16===i,onClick:function(){return a(e,n)}},n)}))]})},l=function(t){var e=t.pattern,n=t.lastNotePlayed,i=t.isPlaying,a=t.toggleNote;return Object(c.jsx)("div",{className:"uk-margin-small uk-background-secondary uk-light uk-padding",children:Object.keys(e).map((function(t){return Object(c.jsx)(u,{trackName:t,trackNotes:e[t],lastNotePlayed:n,isPlaying:i,toggleNote:a},t)}))})},h=function(t){var e=t.isPlaying,n=t.onClick;return Object(c.jsx)("div",{className:"play-button-component",children:Object(c.jsx)("button",{type:"button",className:"uk-button uk-button-primary",onClick:n,onKeyDown:function(t){" "===t.key&&t.preventDefault()},children:e?"Stop":"Play"})})},d=function(t){var e=t.value,n=t.onChange;return Object(c.jsx)("div",{className:"tempo-control-component",children:Object(c.jsx)("div",{className:"uk-form-controls",children:Object(c.jsx)("input",{id:"tempo",className:"uk-input",type:"number",placeholder:"Tempo","aria-label":"Tempo",min:20,max:300,step:1,value:e,onChange:function(t){var e=parseFloat(t.target.value);n(e)}})})})},m=n(14),g=n(15),p=n(16),j=n.n(p),f=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{onTempoChange:function(){},onIsPlayingChange:function(){},onNotePlayed:function(){},onPatternChange:function(){},onLoadingDone:function(){}};Object(m.a)(this,t),this.audioContext=new AudioContext,this.unlocked=!1,this.isPlaying=!1,this.startTime=null,this.current16thNote=null,this.tempo=80,this.lookahead=25,this.scheduleAheadTime=.1,this.nextNoteTime=0,this.noteLength=.05,this.timerID=null,this.pattern={clap:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],clave:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],conga_hi:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],conga_mid:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],conga_low:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],cowbell:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],cymbal:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],hihat_closed:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],hihat_open:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],kick:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],maracas:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],rim:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],snare:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],tom_hi:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],tom_mid:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],tom_low:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1]},this.onTempoChange=n.onTempoChange,this.onIsPlayingChange=n.onIsPlayingChange,this.onNotePlayed=n.onNotePlayed,this.onPatternChange=n.onPatternChange,this.onLoadingDone=n.onLoadingDone,this.loading=!0,this.audioData={};for(var i=["clap","clave","conga_hi","conga_mid","conga_low","cowbell","cymbal","hihat_closed","hihat_open","kick","maracas","rim","snare","tom_hi","tom_mid","tom_low"],a=[],o=function(){var t=c[s];a.push(j.a.get("/drum-machine"+"/clips/".concat(t,".mp3"),{responseType:"arraybuffer"}).then((function(t){return e.audioContext.decodeAudioData(t.data)})).then((function(n){e.audioData[t]=n})))},s=0,c=i;s<c.length;s++)o();Promise.all(a).then((function(){e.loading=!1,e.onLoadingDone()}))}return Object(g.a)(t,[{key:"nextNote",value:function(){var t=60/this.tempo;this.nextNoteTime+=.25*t,this.current16thNote++,16===this.current16thNote&&(this.current16thNote=0),this.onNotePlayed(this.current16thNote)}},{key:"scheduleNote",value:function(t,e){for(var n in this.pattern)if(this.pattern[n][t]){var i=this.audioContext.createBufferSource();i.buffer=this.audioData[n],i.connect(this.audioContext.destination),i.start(e)}}},{key:"scheduler",value:function(){for(;this.nextNoteTime<this.audioContext.currentTime+this.scheduleAheadTime;)this.scheduleNote(this.current16thNote,this.nextNoteTime),this.nextNote()}},{key:"setTempo",value:function(t){this.tempo=t,this.onTempoChange(this.tempo)}},{key:"setPattern",value:function(t){this.pattern=t,this.onPatternChange(this.pattern)}},{key:"startStop",value:function(){var t=this;this.unlocked||(this.unlocked=!0,this.audioContext.resume()),this.isPlaying=!this.isPlaying,console.log(this.isPlaying),this.isPlaying?(this.current16thNote=0,this.nextNoteTime=this.audioContext.currentTime+.1,this.timerID=setInterval((function(){return t.scheduler()}),this.lookahead)):(clearInterval(this.timerID),this.timerID=null),this.onIsPlayingChange(this.isPlaying)}}]),t}(),b=function(){var t=Object(i.useRef)(null),e=Object(i.useState)(80),n=Object(s.a)(e,2),a=n[0],o=n[1],r=Object(i.useState)(!1),u=Object(s.a)(r,2),m=u[0],g=u[1],p=Object(i.useState)(null),j=Object(s.a)(p,2),b=j[0],k=j[1],y=Object(i.useState)({}),x=Object(s.a)(y,2),v=x[0],N=x[1],O=Object(i.useState)(!0),P=Object(s.a)(O,2),C=P[0],T=P[1];Object(i.useEffect)((function(){t.current=new f({onTempoChange:function(t){o(t)},onIsPlayingChange:function(t){g(t)},onNotePlayed:function(t){k(t)},onPatternChange:function(t){N(t)},onLoadingDone:function(){T(!1)}}),o(t.current.tempo),g(t.current.isPlaying),k(t.current.current16thNote),N(t.current.pattern)}),[]),Object(i.useEffect)((function(){var t=function(t){" "===t.key&&w()};return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}}),[]);var w=function(){t.current.startStop()};return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{className:"uk-flex uk-background-muted uk-margin-small uk-flex-middle",children:[Object(c.jsx)("div",{className:"uk-padding-small",children:"Drum Machine App"}),Object(c.jsx)("div",{className:"uk-flex-1"}),Object(c.jsx)("div",{className:"uk-padding-small",children:Object(c.jsx)(d,{value:a,onChange:function(e){return t.current.setTempo(e)}})}),Object(c.jsx)("div",{className:"uk-padding-small",children:Object(c.jsx)(h,{isPlaying:m,onClick:w})})]}),C?Object(c.jsx)("div",{className:"uk-margin uk-text-center",children:Object(c.jsx)("div",{"uk-spinner":"true"})}):Object(c.jsx)(l,{pattern:v,lastNotePlayed:b,isPlaying:m,toggleNote:function(e,n){var i=Object.assign({},v);i[e][n]=!i[e][n],t.current.setPattern(i)}})]})},k=function(){return Object(c.jsx)("div",{className:"uk-container uk-container-small",children:Object(c.jsx)("div",{className:"uk-margin-auto",children:Object(c.jsx)(b,{})})})};n(40),n(41);o.a.render(Object(c.jsx)(k,{}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.f9842c7a.chunk.js.map